# 3.1

# 3.2 存储器的层次结构

## Cache-主存层次

主要解决CPU速度与主存不匹配的问题

## 主存-辅存层次

主要解决容量问题

# 3.3 半导体随机存储器

## 基本结构

1. 存储矩阵
2. 译码驱动
3. 读写电路
4. 读写控制线
5. 片选线
6. 地址线
7. 数据线

**74138译码器**

## SRAM

静态随机存储器

存储元：双稳态触发器（六管MOS）不需刷新

优点：存取速度快

缺点：集成度低，功耗大

一般用途：高速缓冲存储器

## DRAM

动态随机存储器

存储元：栅极电容

**采用地址复用技术：**
地址线是原来的一半，地址信号分行、列两次传送

优点：集成度高、价位低、容量大、功耗低

缺点：存取速度比SRAM慢

由于电荷维持时间短，需要刷新

### 刷新方式

1、集中刷新

2、分散刷新
优点：无死区
缺点：加长了存取周期，降低了整机的速度

3、异步刷新

**4、透明刷新**
分散刷新的发展，将刷新安排在译码阶段，既不会加长存储周期，又不会有死时间

## 读写周期

![1](/0301.JPG)
![](/media/15625158628582.jpg)

$A$:地址线信号

$\overline{CS}$:片选信号

$D_{out}$:数据输出信号

## 只读存储器（ROM）

# 3.4 主存储器与CPU的连接

## 容量扩展

### 位扩展

### 字扩展

### 字位同时扩展

## 地址分配与片选

CPU对存储单元进行访问，先进行片选，在进行字选（片内字选）

### 片选常用方法

1、线选法

2、译码片选法

# 3.5 双端口RAM和多模块存储器

## 双端口RAM

## 多模块存储器

### 单体多字存储器

### 多体并行存储器

两种：
1、高位交叉（顺序存储）

2、低位交叉（交叉存储）

#### 相关计算：

交叉存取度：

$M = \frac{T}{r}$

T:存取一个字的周期
r:总线传送周期

为实现流水线方式存取，交叉模块数应大于等于该值

连续存取m个字的时间为：

$T_1 = T + (M - 1)r$

以高位交叉方式(顺序方式)连续读取所需时间为：

$T_2 = MT$

# 3.6 Cache（高速缓存器）

## 程序访问的局部性原理

时间局部性

空间局部性

## 基本工作原理

## Cache和主存的映射方式

### 直接映射

映射关系：

$j = i\ \%\ 2^c$

j:Cache块号（行号）
i:主存的块号
c:Cache中的总块数

地址结构：
|主存地址标记|Cache字块地址|字块内地址|
|---|---|---|

块冲突则无条件替换

### 全相联映射

地址结构：
|主存字块标记|字块内地址|
|---|---|

需要昂贵的按内容寻址的相联存储器，成本高

### 组相联映射

前两者的组合

$j = i\ \%\ Q$

j:Cache块号（行号）
i:主存的块号
Q:Cache中的组数

地址结构：

|主存字块标记|组地址|字块内地址|
|---|---|---|

# 3.7 虚拟存储器

## 基本概念

实地址=主存页号 + 页内（字）地址

虚地址=虚存页号+页内（字）地址

辅存地址=磁盘号+盘面号+磁道号+扇区号

## 页式存储器

$页表项地址 = 页表起始地址+虚页号$

**页表**是记录虚页调入主存时被放入主存的位置，一般永久保存在内存中（断电失效？）

**页表项**
1. 装入位（1：已在内存中功能；0：不在内存，启动I/O掉入内存）
2. 虚页号（页框号）

通过页表地址（页框号）去页表里找到对应的实页号

实页号+页内地址=实地址

优点：
1. 页面长度固定
2. 页表简单
3. 掉入方便

缺点：
1. 最后一页的零头可能无法完全利用（操作系统：产生内部碎片）而造成浪费
2. 页不是逻辑上的独立实体，所以处理、保护和共享都不及段式存储器方便

## 段式存储器

段是按程序中的逻辑结构来划分的

段的长度因程序而异

$虚拟地址 = 段号+段内地址$

## 段页式存储器

## 快表