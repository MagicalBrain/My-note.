# 摸索如何限制伯朗特机器人的J6关节的旋转角度

## Aubo机器人插件的限制代码

## 解决方案1

J6旋转之前获取当前的$w$的值为$w_0$，目标点的$w$为$w_1$。
判断一下$\Delta W = w_1 - w_0$，如果$\Delta W$的绝对值大于180，则根据符号加或者减180.
$\Delta W > 180$，则$\Delta W - 180$
$\Delta W > -180$，则$\Delta W + 180$

```cpp
int BorunteRobotPlugin::navigation(const hy::NavigationParam& originParam, int type /*= hy::ROBOT_POSE_TCP*/)
{
	if (!this->connected())
	{
		HY_LOG_SEV(error) << "robot is not connected";
		return PLUGIN_ERROR_FAIL;
	}

	hy::NavigationParam limitedParam;
	checkoutAxisConfig(originParam, limitedParam);
	hy::NavigationParam param = limitedParam;

	//定义起始点
	std::vector<double> start_loc;
	//获取当前的位置为起始位置
	this->pose(start_loc);
	//张开电爪
	this->run("Put");
	
	if (PLUGIN_ERROR_FAIL == this->setPos(start_loc, start_pos_addr_))
		return PLUGIN_ERROR_FAIL;
    
    //20210422判断w的旋转角度是否大于180
    double w_delta = start_loc[5] - param.Destination[5];
	if (w_delta > 180)
	{
		param.Transition[5] -= 180;
		param.Destination[5] -= 180;
	}
	if (w_delta < 180)
	{
		param.Transition[5] += 180;
		param.Destination[5] += 180;
	}

	if (PLUGIN_ERROR_FAIL == this->setPos(param.Transition, transition_addr_))
		return PLUGIN_ERROR_FAIL;
	if (PLUGIN_ERROR_FAIL == this->setPos(param.Destination, target_addr_))
		return PLUGIN_ERROR_FAIL;
	if (PLUGIN_ERROR_FAIL == this->setPos(coordinate_.Positions[param.Position], put_pos_addr_))
		return PLUGIN_ERROR_FAIL;

	//开始
	this->run("MoveStartFlag");

	//等待机器人完成抓取并反馈
	using namespace std::literals::chrono_literals;
	while (!this->run("MoveDoneFlag"))
	{
		std::this_thread::sleep_for(100ms);
	}
	this->run("Done");
	return PLUGIN_ERROR_SUCESS;
}
```