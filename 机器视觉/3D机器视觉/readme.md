# 3D机器视觉

## 相机标定

## 相机的成像系统

## 3 相机标定基础

### 3.1 平面的单应性关系

定义：
从一个平面到另一个平面的投影映射。
世界坐标系的物体平面到成像平面之间的映射，即两个平面之间的单应性关系

模型平面：
标定使用的标定板平面

模型平面上一点：
$
Q=[X, Y, Z, 1]^T
$ （向量增广为了方便计算）
映射到成像平面上的点：$$q = [X, Y, Z]^T$$
他们二者之间的单应性关系: $$q= s \cdot H \cdot Q$$

$H:$单应性矩阵，单应性矩阵有8个自由度，8个自由参数需要求解

四个点可以得到8个方程，所以至少有8个点就可以求解单应性关系

Opencv接口： 

```
fingHomography()
```

求解方法：
1.重投影误差最小化;
2.RANSAC

### 3.2 基本方程

**基本变量**
二维点： 
$m = [u, v]^T$
对应的三维空间的点$M=[X, Y, X]^T$

添加1得到增广向量：$m = [u, v, 1]^T， M = [X， Y， Z， 1]^T$
根据前面的小孔成像模型，三维点到投影点的关系可以描述为:$sm=A[Rt]M$

$s$:转换尺度因子，

$[R, t]$:外参，旋转平移矩阵
$$A = 
\begin{pmatrix}
   \alpha & \gamma & u_0 \\
   0  & \beta & v_0\\
   0 & 0 & 1 \\
\end{pmatrix}$$

$(u_0, v_0)$: 代表图像坐标系原点（光心）相对像素坐标系原点的偏移量

$(\alpha, \beta)$: 焦距除以单个像素的大小，在两个轴的比例因子

$\gamma$:两个坐标轴的倾斜角的参数

前面没有提到，因为我们认为两个坐标轴是垂直的，实际可能会不垂直

**相机标定**

我们可以假设，标定板平面在世界坐标系的$Z$坐标是0，$R$的第$i$列矩阵为$r_i$那么可以得到

$$$$
