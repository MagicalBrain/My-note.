# 双臂机器人位姿转换

现在就是想把两个机械臂的坐标相互转换、或者转换到同一坐标系下。

## x, y, z坐标转换

设相机坐标系原点位置为$V$，机械臂手眼标定矩阵为$R$，机械臂基坐标系下末端位置为$W$

有公式：
$$W = R \cdot V \tag{1}$$

----

假设我们有两个机械臂，一个相机。
设相机坐标系原点位置为$V$，左臂手眼标定矩阵为$R_{left}$，机械臂基坐标系下末端位置为$W_{left}$,
右臂手眼标定矩阵为$R_{right}$，机械臂基坐标系下末端位置为$W_{right}$

则有：

$$W_{left} = R_{left} \cdot V \tag{2.1}$$

$$W_{right} = R_{right} \cdot V \tag{2.2}$$

由于相机只有一个，则$V$只有一个，我们可以利用2.1式将2.2式中的$V$消掉：

$$V = R_{left}' \cdot W_{left} \tag{2.3}$$

将2.3式代入到2.2式，则有：

$$W_{right} = R_{right} \cdot R_{left}' \cdot W_{left} \tag{2.4}$$

==注意：==

此时的$W_{right}$是四维向量$[x, y, z, 1]$。
目前为止没有涉及到旋转角`u, v, w`的计算和转换

==其实可以不用手眼矩阵来进行转换得。==

首先手眼矩阵本身就有误差，而且误差再怎么控制都有2~3mm，如果我们有上面的方法来对左右臂坐标进行转换，那么由2.4式可得转换矩阵为

$$^{left}_{right}T = R_{right} \cdot R_{left}'$$

根据误差传播定律，两个机械臂的手眼矩阵的误差都将在转换矩阵$^{left}_{right}T$中得到放大。

但实际上我们可以不用通过两个机械臂的手眼矩阵来得到转换矩阵$^{left}_{right}T$

## u, v, w旋转角转换

首先我们知道u, v, w是可以通过旋转矩阵得到得

那我们先把旋转矩阵算出来

设$R_{right}$为右臂末端相对于右臂基座得旋转角， $R_{left}$为左臂末端相对于左臂基座得旋转角，$^{left}_{right}T$则是左臂基座坐标系相对于右臂基座坐标系得转换矩阵
