# 机械臂和机器人插件的使用及二次开发

[toc]

## 机械臂机器人的使用

目前公司又在使用的机器人有：
1. Aubo机器人
2. 伯朗特机器人
3. ABB机器人
4. UR机器人
5. KUKA机器人

### Windows系统修改IP地址

在Windows系统电脑上打开网络设置，手动设置电脑的IP地址。

在电脑上打开cmd，用ping指令检查机器人的IP地址是否能连通。

如果ping不通，可以关闭防火墙再试一次。

具体可参照百度：Windows系统如何修改IP地址

### 傲博机器人（Aubo）

#### 启动机器人

启动机器人之前先确保各种线缆连接好：

1. 检查机器人与控制柜是否连接完好。
2. 检查示教器与控制柜之间是否连接完好。
3. 检查控制柜电源电缆是否连接完好。
4. 控制柜电源开关在电源未接通时处于关闭状态.
5. 示教器急停开关处于弹起状态。
6. 模式选择按钮处于正确的位置。
7. 确保机器人不会碰到周围人员或设备。

打开机器人控制器上的开关：

![](asset/Aubo/IMG_F009EF43A8CB-1.jpeg)

等待POWER和STANDBY指示灯亮起。

接下来按下Aubo机器人的示教器启动按钮：

![](asset/Aubo/IMG_87A0AF155A6C-1.jpeg)

示教器开机后进入登录界面：

![](asset/Aubo/IMG_C2CE95767B8B-1.jpeg)

使用admin用户登录即可，默认密码为1.

进入初始化界面：

![](asset/Aubo/IMG_4C6940575369-1.jpeg)

依次点击**保存**和**启动**按钮，等待数十秒后即可进入机器人控制界面。

#### 手动操作机器人

手动操作机器人主要是为了手眼标定以及机器人复位的情况。

示教器控制界面如下：

![](asset/Aubo/IMG_2884.jpg)

控制机器人有两种方式，一种是直接修改世界坐标(x/y/z/u/v/w)，另一种是修改关节坐标。

**修改世界坐标**：
通过世界坐标控制机器人分为两部分，一部分为**位置控制**，另一部分为**姿态控制**。当你手持示教器正对着机器人的时候，位置控制的XYZ箭头与世界中机器人的运动方向是一致的。

#### 配置IP地址

点击上方的**菜单栏**中的**设置**。

然后在左侧的选项中依次点击**系统**->**网络**如下图所示：

![](asset/Aubo/IMG_2885.jpg)

网卡的选择如图即可，IP地址修改的是机器人的IP地址。

需要注意的是：
1. 机器人的IP地址与上位机的地址需要保持在统一个网段（前三段需相同）
2. 网关和掩码也需保持相同

修改好后重启机器人，然后重新进入此界面，先在下面的**网络调试**中输入上位机的IP地址ping一下看是否能够ping通，还可点击ifconfig查看机器人的IP地址是否修改成功。

#### 工具标定

点击上方的**菜单栏**中的**设置**。

然后在左侧的选项中依次点击**机械臂**->**工具标定**如下图所示：

![](asset/Aubo/182BC986-5CD4-4C44-A36B-38449B7EB57F_1_105_c.jpeg)

点击下方的添加按钮，添加一个新的工具。

然后在上方的菜单栏里点击**运动学标定**，如下图所示：

![](asset/Aubo/0F25562A-F919-4FFA-A174-369D7D3138BE_1_105_c.jpeg)

在左下方修改工具相对于机器人末端的变化值，一般估计抓具的长度$L$，然后在Z值那里添加一个正的$L$。

接下来点击上方的菜单栏里点击**动力学标定**，如下图所示：

![](asset/Aubo/25DDB3CF-3240-4BCF-838C-7E6188178027_1_105_c.jpeg)

选中之前添加的工具，在下面修改负载，一般只需要一个估计值。

#### 用户IO

Aubo插件设置了IO 0为触发拍照的IO。

工具IO则由IO_task.json里查看，如果需要接线，则要找一个工具用来戳开电排（小的一字螺丝刀最佳）。



参考资料：《Aubo i5使用手册》

### 伯朗特机器人（Borunte）

#### 配置IP地址

在示教器里的“参数设置”->“通讯设置”，设置机器人的IP地址，输入电脑的IP地址，勾选主机使能、服务器模式，最后点击确定修改。

#### 手动操作机器人

将示教器模式打到手动

![](asset/Borunte/IMG_1220.jpg)

打开运动控制键盘，如下图：

![](asset/Borunte/IMG_C6DDC4D2029F-1.jpeg)

在按下按键使机器人运动的同时，还需要按住使能键：

![](asset/Borunte/IMG_C9A3DCA2CDC8-1.jpeg)

图中的安全开关即使能键。

#### 运行示教器程序

要运行一个事先写好的示教器程序用来控制机器人运动到HYpick发送的点位，实现抓取、放料整个过程。

#### 设置工具IO

![](asset/Borunte/IMG_2631.jpg)

### 库卡机器人（KUKA）

#### 登录账户提权

因为kuka机器人处于安全方面的考虑许多操作要提权。

查看dat表等大部分操作需要专家权限。

从WorkVisual导入项目进机器人控制系统，要安全调试员权限。

按下**Home**键：

![](asset/KUKA/IMG_674A4A0D387D-1.jpeg)

上图中右边最下面的按钮。

点击**配置**->**用户组**，进入用户切换界面：

![](asset/KUKA/IMG_2848.jpg)

![](asset/KUKA/IMG_2849.jpg)

点击对应的用户组名称即可进入，默认登录密码为：kuka。

#### 配置IP地址

首先需要提权进入专家用户组。

主菜单-> 投入运行 -> 网络配置

![](asset/KUKA/IMG_2848的副本.jpg)

如图，即为打开的网络设置界面：

![](asset/KUKA/IMG_2819.jpg)

配置完成后需要重启才能保存设置。

**注意**：
IP地址不可乱填，有些IP地址是内部专用的，推荐使用原来的地址（172.31开头的）
```bash
172.31.55.6
```

#### 修改机器人运动的速度

修改机器人运动的速度可以在示教器上进行，也可以在示教器程序里面修改。

示教器上修改运动速度，只需按下下图中的按钮：

![](asset/KUKA/IMG_2815.jpg)

图中的右下方“三角形”对应的加减号按钮修改的是自动模式下机器人的速度，默认为100%；“手形”对应的加减号按钮修改的是手动模式下的机器人的速度。

#### 手动操作机器人

和伯朗特类似，这些工业机器人在手动操作的时候都需要按住一个使能按钮（确认按钮），而且按住的时候不能完全按死。

确认按钮位置如下图：

![](asset/KUKA/IMG_F3B33027D318-1.jpeg)

图中的编号为1、3、5的按钮为确认按钮，实际使用中按下任意一个即可。

使用示教器上的按钮控制机器人

![](asset/KUKA/IMG_2815.jpg)

如上图，A1上面的按钮按下后可选择手动控制机器人的坐标系（基坐标xyzuvw还是关节坐标）

接下来的6对加减按钮则是修改对应坐标的按钮。例：A1旁边的加减按钮即修改A1关节旋转角度的按钮，以此类推。

除了使用按钮改变机器人实时运动的坐标外，还可以使用6D鼠标（不推荐，使用困难）。

#### 运行示教器程序

##### 手动模式

有两种：
1. T1
2. T2

T1:
以设置好的手动速度运行——手动慢速

T2：
以设置好的自动速度运行，但禁用使能开关（或者说确认开关，按下了启动按钮才有效，但不会使能），相当于一个测试模式

##### 自动模式

有两种：
1. AUT
2. EXT

AUT：
以设置好的自动速度运行，但程序的启动需要在示教器上按下启动键

EXT：
运行开始是需要另外一个PLC控制柜给出启动信号，运行开始后示教器上只有急停按钮起作用，其它所有按键会被禁用。

##### BCO运行

如果想要让示教器里的程序自动运行，则可能需要用BCO运行

首先进入T1模式，选定要运行的程序，然后按下确认键的同时按下启动键。直到提示说“已到达BCO”，此时保持选定程序的状态不变，然后切换到AUT，此时你会发现之前在T1状态下变红的“R”指示灯又变成绿色的了。

## 插件的使用

首先得配置好开发环境，具体参考[HYSDK][hysdk]。

[hysdk]:https://e.gitee.com/shenzhen-hinyeung/repos/shenzhen-hinyeung/hysdk/sources

配置好开发环境后，用vs2019打开RobotPlugin项目工程

## 二次开发

由于安装好了hysdk，所以我们可以利用这个hysdk来进行二次开发，编写能够被pick调用的插件。
