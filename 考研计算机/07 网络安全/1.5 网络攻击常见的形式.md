# 1.5 网络攻击的常见形式

[toc]

==网络攻击其实就是安全攻击的具体形式。==

## 1.5.1口令窃取



进入一台计算机最容易的方法就是采用口令登录。只要在许可的登录次数范围内输入正确的口令，就可以成功地登录系统。

虽然利用系统缺陷破坏网络系统是可行的，但这不是最容易的办法。最容易的办法是通过窃取用户的口令进入系统。事实上，很大比例的系统入侵是由口令系统失效造成的。

口令系统失效的原因有多种，但最常见的原因是人们倾向于选择很糟糕的口令作为登录密码。反复研究的结果表明:口令猜测很容易成功我们并不是说所有人都采用了很差的口令，但对于黑客来说，只要给他一次机会就可以得手。



**口令猜测攻击**有三种基本方式。

第一种方式是利用已知或假定的口令尝试登录。虽然这种登录尝试需要反复进行十几次甚至更多，但往往会取得成功。一旦攻击者成功登录，网络的主要防线就会崩溃。很少有操作系统能够抵御从内部发起的攻击。

第二种方式是根据窃取的口令文件进行猜测（如UNIX系统中的etc/passwd文件）。这些口令文件有的是从已经被攻破的系统中窃取的，有的是从未被攻破的系统中获得的。由于用户习惯重复使用同一口令，当黑客得到这些文件后，就会尝试用其登录其他机器。这种攻击称为“字典攻击”，通常十分奏效。

第三种方法是窃听某次合法终端之间的会话，并记录所使用的口令。采用这种方式，不管用户的口令设计得有多好，其系统都会遭到破坏。



通过以上讨论可以得出结论:在选择好的口令方面，加强对用户的培训是非常重要的。大多数人习惯选择简单的口令。虽然人们也试图选用难以猜测的密码，但收效不大。据统计，攻击者如果掌握一本小字典，他就有20％的机会进入系统。况且现在可以获得的字典很多，大的可以达到几十兆字节。字典里几乎包括所有单词和短语，还有各种个人信息，如电话号码、地址、生日、作家名字等。

如果无法阻止选择低级的口令，那么对口令文件进行严格保护就变得非常关键要做到这点，就必须进行以下操作:

（1）对某些服务的安全属性进行认真配置如SUN操作系统中的NIS服务；

（2）对可以使用tftpd协议获得的文件加以限制；

（3）避免将真正的etc/passwd文件放在匿名FTP区。

某些UNIX系统提供了对合法用户的口令进行杂凑计算并将该杂凑值进行隐藏的功能。杂凑后的口令文件称为“影子”或“附属”口令文件。我们强烈建议充分利用系统的这一功能。除了UNIX系统之外，还有很多系统也具备对口令进行杂凑和隐藏的功能。

要彻底解决使用口令的弊端，就要完全放弃使用口令机制，转而使用基于令牌（Token-based-）的机制。如果暂时还不能做到，起码要使用一次性口令方案，如OTP （One-Time Password）。



## 1.5.2欺骗攻击

黑客的另外一种攻击方式是采用欺骗的方式获取登录权限。泄密通常发生在打电话和聊天的过程中。请看 Thompson与网络管理员的一段谈话:



 "This is Thompson. Someone called me about a problem with the Is command. He'd like me to fix it."

 "Oh, OK. What should I do?"

 "Just change the password on my login on your machine; it's been a while since I've used it."

 'No problem."



“这是汤普森。有人打电话给我说Is命令有问题。他想让我来修理它。”

“哦,好的。我该怎么办?”

“在你电脑上把我登录机器的密码改了吧;我已经有一段时间没用过它了。”

“没有问题。”



从上面的谈话可以看出, Thompson欺骗网络管理员改变口令,使他能够成功登录到其计算机上。还有其他的欺骗方式,如利用邮件欺骗。请看攻击者发出的这封邮件:



 from: smb @research.att.com

 to: admin @research. att.com

 Subject:Visitor

 We have a visitor coming next week. Could you ask for your SA to add a Login for her? Here's her passwd line; use the same hashed password.

 Pxf: 5bHD/k5k2mtTTs: 2403: 147 Pat: /home/pat: /bin/sh



注意,这封邮件明显带有欺骗行为。如果Pat是一个来访者,她不会将家里的机器口令拿到外面使用。因此,在没有搞清方的真正意图之前,就不能随意采取行动。

当你收到一个朋友的电子邮件,警告你“sulfnbk.exe是一个病毒文件,必须删除。请转告你的朋友。”这种电子邮件很可能就是一个骗局。如果你照此去做,你的系统就会中毒并遭到破坏。不幸的是,很多人都会上当,因为这个邮件毕竟是自己的朋友发送来的。



## 1.5.3缺陷和后门攻击



网络蠕虫传播的方式之一是通过向 finger守护程序（ Daemon）发送新的代码实现的。显然，该守护程序并不希望收到这些代码，但在协议中没有限制接收这些代码的机制。

守护程序的确可以发出一个gets呼叫，但并没有指定最大的缓冲区长度。蠕虫向“读”缓冲区内注入大量的数据，直到将gets堆栈中的返回地址覆盖。当守护程序中的子程序返回时，就会转而执行入侵者写入的代码。

#### 1、缓冲器溢出攻击：

缓冲器溢出攻击也称为“堆栈粉碎”（ Stack Smashing）攻击。这是攻击者常采用的一种扰乱程序的攻击方法。

长期以来，人们试图通过改进设计来消除缓冲器溢出缺陷。有些计算机语言在设计时就尽可能不让攻击者做到这点。一些硬件系统也尽量不在堆栈上执行代码。此外，一些C编译器和库函数也使用了许多对付缓冲器溢出攻击的方法。

#### 2、利用程序的缺陷：

所谓缺陷（Flaws），就是指程序中的某些代码并不能满足特定的要求。尽管一些程序缺陷已经由厂家逐步解决，但是一些常见问题依然存在。

最佳解决办法就是在编写软件时，力求做到准确、无误。然而，软件上的缺陷有时是很难避免的，这正是今天的软件中存在那么多缺陷的原因。

#### 3、蠕虫攻击：

 Morris蠕虫及其许多现代变种给我们的教训极为深刻，其中最重要的一点是:

缺陷导致的后果并不局限于产生不良的效果或造成某一特定服务的混乱，更可怕的是因为某一部分代码的错误而导致整个系统的瘫痪。当然，没有人有意要编写带有缺陷的代码。只要采取相应的步骤，我们可以降低其发生的可能性。

#### 缺陷和后门攻击的应对措施

1. 编写网络服务软件的时候注意内存分配
2. 注意检查输入语法的正确性，有时需要借助一些编译器工具
3. 必须遵循最小特权准则
4. 不要为了追求程序的运行效率而忽略对程序正确性的检查。

第一，在编写网络服务器软件时，要充分考虑如何防止黑客的攻击行为。要检验所有输入数据的正确性。

如果程序中使用了固定长度的缓冲器，要确保这些缓冲器不会产生溢出。

如果使用了动态分配存储区的方法，要考虑内存或文件系统的占用情况，同时还要考虑到在系统恢复时也要占用内存和磁盘空间。



第二，必须对输入语法做出正确的定义。如果不能真正理解“正确”这两个字的含义，就不能做出正确性检查。如果不知道什么是合法的，就无法写出输入语法。有时，对于语法正确性的检查需要借助于某些编译工具。



第三，**必须遵守“最小特权”原则**。

不要给网络守护程序授予任何超出其需要的权限。特别在设置防火墙的访问控制规则时，轻易不要授予用户超级用户权限。例如，我们会给本地邮件转发系统的某些模块授予一定的特权，使其能将用户发送的信息复制到另外一个用户的邮箱里。而对于网关上的邮件服务器，我们通常不设置任何特权，它所做的事情仅局限于将邮件从一个网络端口复制到另一个网络端口。



如果进行恰当的设计，即使是那些好像需要授权的服务器，也不再需要授权。

例如，UNIX的FTP服务器，允许用户使用root权限登录，并能够绑定到20端口的数据通道上。对于20端口绑定是协议的要求，但我们可以采用一个更小的、更简单的和更明确的授权程序来做这件事。同样，登录问题也可以由一个前端软件来解决。该前端软件仅处理USER和PASS命令，放弃授权要求，并执行无特权程序。



最后需要指出:不要为了追求效率而牺牲了对程序正确性的检查。如果仅仅为了节约几纳秒的执行时间而将程序设计得既复杂又别出心裁，并且又需要特权，那么你就错了。现在的计算机硬件速度越来越高，节约的这点时间毫无价值。一旦出现安全问题，在清除入侵上所花费的时间和付出的代价将是非常巨大的。



## 1.5.4认证失效



许多攻击的成功都可归结于认证机制的失效。即使一个安全机制再好，也存在遭受攻击的可能性。

例如，一个源地址有效性的验证机制，在某些应用场合（如有防火墙地址过滤时）能够发挥作用，但是黑客可以使用 rpcbind重发某些请求。在这种情况下，最终的服务器就会被欺骗。对于这些服务器来说，这些消息看起来好像源于本地，但实际上来自其他地方。



如果源机器是不可信的，基于地址的认证也会失效。虽然人们可以采用口令机制来控制自己的计算机，但是口令失窃也是常见的事情。

某些认证机制失效是因为协议没有携带正确的信息TCP和IP协议都不能识别发送用户。11和rsh协议要么靠自己去获得这些信息，要么就没有这些信息。如果它们能够得到信息，也必须以安全的方式通过网络传送这些信息。

即使对源主机或用户采用密码认证的方式往往也不能奏效。如前所述，一个被破坏的主机不会进行安全加密。

窃听者可以很容易地从未加密的会话中获得明文的口令，有时也可能对某些一次口令方案发起攻击。对于一个好的认证方案来说，下次登录必须具有唯一的有效口令。有时攻击者会将自己置于客户机和服务器中间，它仅仅转发服务器对客户机发出的“挑战”（challenge，实际上为一随机数），并从客户机获得一个正确的“响应”此时，攻击者可以采用此“响应”信息登录到服务器上。有关此类攻击可参见相关文献。

通过修改认证方案消除其缺陷，我们完全可以挫败这种类型的攻击[4]。基于“挑战/响应”（ Challenge/Response）的认证机制完全可以通过精心设计的安全密码协议来消除这种攻击的威胁。



## 1.5.5协议缺陷



前面讨论的是在系统完全正常工作的情况下发生的攻击。但是，有些认证协议本身就有安全缺陷，这些缺陷的存在会直接导致攻击的发生。

例如，攻击者可对==TCP发起序列号攻击==。由于在建立连接时所生成的初始序列号的随机性不够，攻击者很可能发起源地址欺骗攻击。为了做到公平，TCP的序列号在设计时并没有考虑抵御恶意的攻击。

其他基于序列号认证的协议也可能遭受同样的攻击。这样的协议有很多，如DNS和许多基于RPC的协议。

在密码学上，如何发现协议中存在的安全漏洞是非常重要的研究课题。有时错误是由协议的设计者无意造成的，但更多的安全漏洞是由不同的安全假设所引发的。对密码协议的安全性进行证明非常困难，人们正在加强这方面的研究工作。现在，各种学术刊物、安全公司网站和操作系统开发商经常公布一些新发现的安全漏洞，我们必须要对此加以重视。

安全协议取决于安全的基础。例如，安全壳协议（SSH， Secure Shell）是一个安全的远程存取协议。SSH协议具有这样一个特点:用户可以指定一个可信的公钥，并将其存储于 authorized keys文件中。如果客户机知道相应的私钥，该用户不用输入口令就能登录。在UNX系统中，该文件通常位于用户主目录下的ssh目录中。现在来考虑这样一种情况:有人使用SSH登录到某个加载了NFS主目录的主机上。在这种情况下，攻击者就可以欺骗NFS将一个伪造的 authorized keys文件注入其主目录中。

802.11无线数据通信标准中的WEP协议在设计上也存在缺陷。目前，针对WEP协议的攻击软件在网络上随处可见。这一切说明，真正的安全是很难做到的。工程师在设计密码协议时，应当多向密码学家咨询，而不是随意地进行设计。信息安全对人的技术素质要求非常高，没有进行专业学习和受过专门培训的人员很难胜任此项工作。

现有internet的限制：

1. TCP三次握手

密码学协议：

1. Shal
2. DES（https://zhuanlan.zhihu.com/p/101573396）

WEP与EAP：



## 1.5.6信息泄露



许多协议都会丢失一些信息，这就给那些想要使用该服务的攻击者提供了可乘之机。这些信息可能成为商业间谍窃取的目标，攻击者也可借助这些信息攻破系统。 Finger协议就是这样一个例子。这些信息除了可以用于口令猜测之外，还可以用来进行欺骗攻击。

有时，电话号码和办公室的房间号也可能很有用。我们可以根据电话号码本推理出该组织的结构。

在某些公司的网站上，往往提供了在线的电话号码查询。其实，公司的这些电话号码信息也应该是保密的。因为，当猎头们需要某些具有专业技能的人员时，他们可以根据这些信息打电话找到他们想要的专业人才。

另一个丰富的数据来源是DNS。在这里，黑客可以获得从公司的组织结构到目标用户的非常有价值的数据。要控制数据的流出是非常困难的，唯一的办法是对外部可见的DNS加以限制，使其仅提供网关机器的地址列表。

精明的黑客当然深谙其理，他根本不需要你说出有哪些机器存在。他只需进行端口号和地址空间扫描，就可寻找感兴趣的服务和隐藏的主机。这里，对DNS进行保护的最佳防护措施是使用防火墙。如果黑客不能向某一主机发送数据包，他也就不能侵入该主机并获取有价值的信息。



## 1.5.7指数攻击—病毒和蠕虫



指数攻击能够使用程序快速复制并传播攻击。当程序自行传播时，这些程序称为蠕虫（ Worms）；

当它们依附于其他程序传播时，这些程序就叫做病毒。它们传播的数学模型是相似的，因而两者之间的区别并不重要。这些程序的流行传播与生物感染病毒非常相似。



这些程序利用在很多系统或用户中普遍存在的缺陷和不良行为获得成功。它们可以在几个小时或几分钟之内扩散到全世界[5,6]，从而使许多机构蒙受巨大损失。



 Melissa蠕虫能够阻塞基于微软软件的电子邮件系统达5天之久。各种 Internet各样的蠕虫给造成巨大的负担。这些程序本身更倾向于攻击随机的目标，而不是针对特定的个人或机构。但是，它们所携带的某些代码却可能对那些著名的政治目标或商业目标发起攻击。



有许多方法可以减少感染病毒的概率。最基本的方法是不使用流行的软件。如果采用自行编写的操作系统或应用程序，就不太可能受到感染。目前，针对微软的视窗操作系统的病毒有很多，但 Macintosh和UNIX用户却很少受到病毒感染。



现在这种情况正在发生变化，尤其是针对Linux的攻击越来越多。我们已发现 Linux蠕虫和一些交叉平台的蠕虫能够通过几种平台进行传播，或者通过直接网络访问、网页浏览和电子邮件进行传播。



如果不与受感染的主机通信，就不会感染病毒。通过对网络访问和从外部获得的文件进行严格的控制，就会大大地降低遭受感染的风险。需要引起注意的是，有些病毒是经人工传播的。有人会将消息转发给他的所有朋友，并指示他们将此信息再转发给他们的所有朋友，依此类推。那些缺乏计算机知识的用户就会照此去做。这样，接收到这一消息的用户就会受到感染。在某些情况下，这些消息往往指示你删除某个关键的文件。如果真的照此去做，你的计算机就会受到损害。



对于已知的计算机病毒，采用流行的查杀病毒软件来清除非常有效。但是这些软件必须经常升级，因为病毒的制造者和杀毒软件厂商之间正进行着一场较量。现在，病毒隐藏的隐蔽性越来越高，使得杀毒软件不再局限于在可执行代码中寻找某些字符串。它们必须能够仿效这些代码并寻找滤过性病毒的行为特征。由于病毒越来越难以发现，病毒检测软件就不得不花更多的时间来检查每个文件，有时所花费的时间会很长。病毒的制造者可能会巧妙地设计代码，使杀毒软件在一定的时间内不能识别出来。



## 1.5.8拒绝服务攻击



在前面讨论的攻击方式中，大多数是基于协议的弱点、服务器软件的缺陷和人为因素而实施的。



拒绝服务（Dos， Denial-of-Service-）攻击则与之不同，它们仅仅是过度使用服务，使软件、硬件过度运行，使网络连接超出其容量。目的是造成自动关机或系统瘫痪，或者降低服务质量。这种攻击通常不会造成文件删除或数据丢失，因此是一种比较温和的攻击。



这类攻击往往比较明显，较容易发现。例如，关闭一个服务很容易被检测到。尽管攻击很容易暴露，但要找到攻击的源头却十分困难。这类攻击往往生成伪装的数据包，其中含有随机和无效的返回地址。



分布式拒绝服务（DDo， Distributed Denial-Ser-of-）攻击使用很多 Internet主机，同时向某个目标发起攻击。通常，参与攻击的主机却不明不白地成为攻击者的帮凶。这些主机可能已经被攻击者攻破，或者安装了恶意的代码。DDoS攻击通常难以恢复，因为攻击有可能来自世界各地。



目前，由于黑客采用DDoS攻击成功地攻击了几个著名的网站，如 Yahoo、微软及SCO等，它已经引起全世界的广泛关注DDoS其实是DoS攻击的一种，不同的是它能够使用许多台计算机通过网络同时对某个网站发起攻击。它们的工作原理如下。

（1）黑客通过Internet将木马程序植入尽可能多的计算机上。这些计算机分布在全世界不同的区域。被植入的木马程序绑定在计算机的某个端口上，等待接受攻击命令。

（2）攻击者在 Internet的某个地方安装一个主控程序，该主控程序中含有一个木马程序所处位置的列表。此后，主控程序等待黑客发出命令。

（3）攻击者等待时机，做好攻击命令前的准备。

（4）等攻击的时机一到，攻击者就会向主控程序发出一个消息，其中包括要攻击的目标地址。主控程序就会向每个植入木马程序的计算机发送攻击命令，这个命令中包含攻击目标的地址。

（5）这些木马程序立即向攻击目标发送大量的数据包。这些数据包的数量巨大，足以使其瘫痪。



从主控程序向下发出的攻击命令中通常使用伪装的源地址，有些则采用密码技术使其难以识别。从植入木马程序的计算机发出的数据包也使用了伪装的IP源地址，要想追查数据包的来源非常困难。此外，主控程序常常使用ICMP响应机制与攻击目标通信。许多防火墙都开放了ICMP协议。



现在网络上流行许多DDOS攻击工具，还有它们的许多变种。其中之一是 Tribe Flood Network（TFN）。从许多网站上都可以获得其源代码。黑客可以选择使用各种 Flood技术，如 UDP Flood， TCP SYN Flood，ICMP响应 Flood， Smurf攻击等。从主控程序返回的ICMP响应数据包会告诉木马程序采用哪一种 Flood攻击方式此外，还有其他DDOS工具，如TFN2K（比TFN更先进的工具，可以攻击 Windows NT和许多UNIX系统）， Trinoo和 Stacheldraht等。最后一个工具十分先进，它具有加密连接和自动升级的特征。



现在一些新的工具越来越高明。 Slapper是一个攻击Linux系统的蠕虫，它可以在许多网络节点中间建立实体到实体（peer--peer）的网络，使主控程序的通信问题变得更容易。还有一些工具则使用IRC信道作为控制通道。



对于拒绝服务攻击，没有什么灵丹妙药，我们只能采取一些措施减轻攻击的强度，但绝对不可能完全消除它们。遇到这种攻击时，可以采取以下四种办法来进行处理:

（1）寻找一种方法来过滤掉这些不良的数据包；

（2）提高对接收数据进行处理的能力；

（3）追查并关闭那些发动攻击的站点；

（4）增加硬件设备或提高网络容量，以从容处理正常的负载和攻击数据流量。

当然，以上这些措施都不是完美的，只能与攻击者展开较量。到底谁能取得这场斗争的胜利，取决于对手能够走多远。

## 总结

**背诵口诀：一门一骗，拒绝病毒，口令泄露，认证协议。**

