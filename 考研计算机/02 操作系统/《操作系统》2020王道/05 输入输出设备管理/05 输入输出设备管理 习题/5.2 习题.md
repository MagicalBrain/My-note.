# 5.2 输入输出子系统

## 选择题

#### 3、下列？不是设备的分配方式

A、独享分配
B、共享分配
C、虚拟分配
D、分区分配

正解：D

解析：
设备分配主要有：
1. 独享分配
2. 共享分配
3. 虚拟分配

分区分配是内存的分配方式

#### 7、【2012统考真题】下列选项中，不能改善磁盘设备IO性能的是

A.重排IO请求次序
B.在一个磁盘上设置多个分区
C.预读和滞后写
D.优化文件物理块的分布

7.B
对于A，重排请求次序也就是进行I/O调度，使进程之间公平地共享磁盘访问，减少IO完成所需要的平均等待时间。
对于C，缓冲区结合预读和滞后写技术对于具有重复性及阵发性的IO进程改善磁盘IO性能很有助。
对于D，优化文件物理块的分布可以减少寻找时间与延迟时间，从而提高磁盘性能。在一个磁盘上设置多个分区与改善设备IO性能并无多大联系，相反还会带来处理的复杂性，降低利用率。

#### 9、在采用 SPOOLing技术的系统中，用户的打印结果首先被送到（）

A.磁盘固定区域
B.内存固定区域
C.终端
D.打印机

9.A
输入井和输出井是在磁盘上开辟的两大存储空间。
输入井模拟脱机输入时的磁盘设备，用于暂存I设备输入的数据；
输出井模拟脱机输出时的磁盘，用于暂存用户程序的输出数据。
为了缓和CPU，打印结果首先送到位于磁盘固定区域的输出井。

#### 11、设从磁盘将一块数据传送到缓冲区所用的时间为$80\mu s$，缓冲区中的数据传送到用户区所用的时间为$40\mu s$，CPU处理一块数据用时$30 \mu s$。若有多块数据需要处理，并采用单缓冲区传送某数据，系统所用的总时间为？

A、$120 \mu s$
B、$110\mu s$
C、$150\mu s$
D、$70\mu s$

正解：A

解析：
由缓冲区的重要特性：
1. 非空时不能冲入数据，只能取出
2. 空时可冲入数据，但必须到满时才可取出

磁盘将数据冲入缓冲区与处理机处理工作区（用户区）里的数据是串行的，这两部分的时间为$\max(80\mu s,30\mu s) = 80\mu s$
再加上从缓冲区到工作区的时间$40\mu s$，即$80\mu s + 40\mu s = 120\mu s$
故选A

#### 12、某操作系统采用双缓冲区传送磁盘上的数据，设从磁盘将数据传送到缓冲区所用的时间为$T_1$，将缓冲区中的数据送入用户区所用时间为$T_2$（假设远小于$T_1$），CPU处理数据用时为$T_3$，则处理该数据，系统所用总时间为？

A、$T_1+T_2+T_3$
B、$\max(T_2,T_3) + T_1$
C、$\max(T_1,T_3)+T_2$
D、$\max(T_1,T_2+T_3)$

正解：D

解析：
双缓冲区处理一块数据的时间为：$\max(数据传送到缓冲区的时间,缓冲区送入工作区的时间+CPU处理工作区的时间)$
即$\max(T_1,T_2+T_3)$

#### 14、【2011统考真题】某文件占10个磁盘块，现要把该文件的磁盘块逐个读入主存缓冲区，并送用户区进行分析，假设一个缓冲区与一个磁盘块大小相同，把一个磁盘块读入缓冲区的时间为100us，将缓冲区的数据传送到用户区的时间是50us，CPU对一块数据进行分析的时间为50us。在单缓冲区和双缓冲区结构下读入并分析完该文件的时间分别是（）

A.$1500\mu s, 1000\mu s$
B.$1550\mu s, 1100\mu s$
C.$1550\mu s, 1550\mu s$
D.$2000\mu s, 2000\mu s$

14.B
在单缓冲区中，当上一个磁盘块从缓冲区读入用户区完成时，下一磁盘块才能开始读入，也就是当最后一块磁盘块读入用户区完毕时所用的时间为$150×10=1500\mu s$，加上处理最后一个磁盘块的时间50us，得1550us.双缓冲区中，不存在等待磁盘块从缓冲区读入用户区的问题，10个磁盘块可以连续从外存读入主存缓冲区，加上将最后一个磁盘块从缓冲区送到用户区的传输时间50us及处理时间50us，也就是100×10+50+50=1100us

#### 17、考虑单用户计算机上的下列I/O操作，需要使用缓冲技术的是？

1. 图形用户界面下使用鼠标
2. 多任务操作系统下的磁带驱动器（假设没有设备预分配）
3. 包含用文件的磁盘驱动器
4. 使用存储器映射I/O，直接和总线相连的图形卡

A、1，3
B、2、4
C、2，3，4
D、全选

正解：D

解析：
在鼠标移动时，若有高优先级的操作产生，为了记录鼠标活动的情况，必须使用缓冲技术，1对
由于磁盘驱动器和目标或源I/O设备间的吞吐量不同，必须采用缓冲区技术，2对
为了是数据从用户作业空间传送到磁盘或从磁盘传送到作业用户空间，必须采用缓冲技术，3对
为了便于多幅图形的存取及提高性能，采用缓冲区技术，4对
故选D

#### 18、提高单机资源利用率的关键技术是？

A、SPOOLing技术
B、虚拟技术
C、交换技术
D、多道程序设计技术

正解：D

解析：
再单机资源中，最关键的是处理器资源，最大化地提高处理器利用率，就是最大化提高系统效率。多道程序设计技术使提高处理器利用率的关键技术
故选D

#### 22、SPOOPLing系统由？组成

A、预输入程序、井管理程序、缓输出[程序]()
B、预输入程序、井管理程序、井管理输出程序
C、输入程序、井管理程序、输出程序
D、预输入程序、井管理程序、输出程序

正解：A

解析：
SPOOLing系统包含三部分：
1. 输入井和输出井：由**预输入程序**管理
2. 输入缓冲区和输出缓冲区：由**井管理程序**管理
3. 输入进程和输出进程：由**缓输出程序**管理

故选A

#### 24、下面关于 SPOOLing系统的说法中，正确的是（）

A.构成 SPOOLing系统的基本条件是有外围输入机与外围输出机
B.构成 SPOOLing系统的基本条件是要有大容量、高速度的硬盘作为输入井和输出井
C.当输入设备忙时， SPOOLing系统中的用户程序暂停执行，待IO空闲时再被唤醒执行输出操作
D. SPOOLing系统中的用户程序可以随时将输出数据送到输出井中，待输出设备空闲时再由SPOOLing系统完成数据的输出操作

24.D
构成SPOOLing系统的基本条件是要有大容量、高速度的==外存==(不一定是硬盘，磁盘也可以)作为输入井和输出井;
因此A、B选项不对，同时利用SPOOLing技术提高了系统和IO设备的利用率，进程不必等待IO操作的完成，因此C选项也不正确。

#### 25、下面关于SPOOLing的叙述中，不正确的是（）

A. SPOOLing系统中不需要独占设备
B. SPOOLing系统加快了作业执行的速度
C. SPOOLing系统使独占设备变成共享设备
D. SPOOLing系统提高了独占设备的利用率

25.A
因为SPOOLing技术是一种典型的虚拟设备技术，它通过将独占设备虚拟成共享设备，使得多个进程共享一个独占设备，从而加快作业的执行速度，提高独占设备的利用率。既然是将独占设备虚拟成共享设备，所以必须先有独占设备才行。

#### 31、在系统内存中设置磁盘缓冲区的主要目的是？

A、减少磁盘I/O的次数
B、减少平均寻道时间
C、提高磁盘数据可靠性
D、实现设备无关性

正解：A

解析：
由于磁盘和内存存在速度差异，决定了可以将内存经常访问的文件调入磁盘缓冲区，从高速缓存中访问比从磁盘读取要快的多
故选A

## 综合题

#### 1.用于设备分配的数据结构有哪些？它们之间的关系是什么？

#### 2.输入/输出软件一般分为4个层次:用户层、与设备无关的软件层、设备驱动程序和中断处理程序。请说明以下各工作是在哪一层完成的:
1）为磁盘读操作计算磁道、扇区和磁头。
2）向设备寄存器写命令
3）检查用户是否有权使用设备。
4）将二进制证书转换成ASCI码以便打印。

#### 3.一个串行线能以最大50000B/s的速度接收输入。数据平均输入速率是20000B/s。若用轮询来处理输入，不管是否有输入数据，轮询例程都需要3us来执行。在下一个字节到达之前未从控制器中取走的字节将丢失。那么最大的安全的轮询时间间隔是多少？

#### 4.在某系统中，从磁盘将一块数据输入缓冲区需要花费的时间为T，CPU对一块数据进行处理的时间为C，将缓冲区的数据传送到用户区所花的时间为M，那么在单缓冲和双缓冲情况下，系统处理大量数据时，一块数据的处理时间为多少？

#### 5.在某系统中，若采用双缓冲区（每个缓冲区可存放一个数据块），将一个数据块从磁盘传送到缓冲区的时间为80us，从缓冲区传送到用户的时间为20us，CPU计算一个数据块的时间为50us。总共处理4个数据块，每个数据块的平均处理时间是多少？

#### 6.一个SPOOLing系统由输入进程I、用户进程P、输出进程O、输入缓冲区、输出缓冲区组成。进程Ⅰ通过输入缓冲区为进程P输入数据，进程P的处理结果通过输出缓冲区交给进程O输出。进程间数据交换以等长度的数据块为单位。这些数据块均存储在同一磁盘上。因此， SPOOLing系统的数据块通信原语保证始终满足i+o≤max，其中max为磁盘容量（以该数据块为单位），为磁盘上输入数据块的总数，O为磁盘上输出数据块的总数。该 SPOOLing系统运行时:只要有输入数据，进程终究会将它放入输入缓冲区；只要输入缓冲区有数据块，进程P终究会读入、处理，并产生结果数据，写到输出缓冲区；只要输出缓冲区有数据块，进程〇终究会输出它。
请说明该 SPOOLing系统在什么情况下死锁。请说明如何修正约束条件以避免死锁，同时仍允许输入数据块和输出数据块均存储在同一个磁盘上